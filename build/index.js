(()=>{"use strict";const e=window.React,l=window.wp.blocks,a=window.wp.i18n,o=window.wp.blockEditor,t=window.wp.components,n=window.wp.element,c=JSON.parse('{"UU":"lazy-load-block/lazy-load-block"}'),r=(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},(0,e.createElement)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z",fill:"currentColor"}));(0,l.registerBlockType)(c.UU,{icon:r,edit:function({attributes:l,setAttributes:c}){const{htmlContent:r,triggerText:i,triggerType:d,placeholderText:s,showPlaceholder:m,placeholderImage:b,autoLoadOnVisible:u,containerWidth:g,containerHeight:p,allowScripts:_}=l,[h,y]=(0,n.useState)(!1),E=(0,o.useBlockProps)({className:"lazy-load-block-editor"}),k=r.toLowerCase().includes("<iframe"),z=r.toLowerCase().includes("<script");return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,a.__)("Configuración del Trigger","lazy-load-block"),initialOpen:!0},(0,e.createElement)(t.TextControl,{label:(0,a.__)("Texto del botón/enlace","lazy-load-block"),value:i,onChange:e=>c({triggerText:e}),help:(0,a.__)("Texto que aparece en el botón para cargar el contenido","lazy-load-block")}),(0,e.createElement)(t.SelectControl,{label:(0,a.__)("Tipo de trigger","lazy-load-block"),value:d,options:[{label:(0,a.__)("Botón","lazy-load-block"),value:"button"},{label:(0,a.__)("Enlace","lazy-load-block"),value:"link"}],onChange:e=>c({triggerType:e})})),(0,e.createElement)(t.PanelBody,{title:(0,a.__)("Placeholder","lazy-load-block"),initialOpen:!0},(0,e.createElement)(t.ToggleControl,{label:(0,a.__)("Mostrar texto de placeholder","lazy-load-block"),checked:m,onChange:e=>c({showPlaceholder:e})}),m&&(0,e.createElement)(t.TextControl,{label:(0,a.__)("Texto del placeholder","lazy-load-block"),value:s,onChange:e=>c({placeholderText:e})}),(0,e.createElement)(o.MediaUploadCheck,null,(0,e.createElement)(o.MediaUpload,{onSelect:e=>c({placeholderImage:e.url}),allowedTypes:["image"],value:b,render:({open:l})=>(0,e.createElement)("div",{className:"llb-media-upload"},(0,e.createElement)(t.Button,{onClick:l,variant:"secondary",style:{marginBottom:"10px"}},b?(0,a.__)("Cambiar imagen","lazy-load-block"):(0,a.__)("Seleccionar imagen de placeholder","lazy-load-block")),b&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("img",{src:b,alt:"",style:{maxWidth:"100%",marginBottom:"10px"}}),(0,e.createElement)(t.Button,{onClick:()=>c({placeholderImage:""}),variant:"link",isDestructive:!0},(0,a.__)("Eliminar imagen","lazy-load-block"))))}))),(0,e.createElement)(t.PanelBody,{title:(0,a.__)("Dimensiones","lazy-load-block"),initialOpen:!1},(0,e.createElement)(t.TextControl,{label:(0,a.__)("Ancho del contenedor","lazy-load-block"),value:g,onChange:e=>c({containerWidth:e}),help:(0,a.__)("Ej: 100%, 600px, 50vw","lazy-load-block")}),(0,e.createElement)(t.TextControl,{label:(0,a.__)("Alto del contenedor","lazy-load-block"),value:p,onChange:e=>c({containerHeight:e}),help:(0,a.__)("Ej: auto, 400px, 50vh","lazy-load-block")})),(0,e.createElement)(t.PanelBody,{title:(0,a.__)("Opciones avanzadas","lazy-load-block"),initialOpen:!1},(0,e.createElement)(t.ToggleControl,{label:(0,a.__)("Cargar automáticamente al ser visible","lazy-load-block"),checked:u,onChange:e=>c({autoLoadOnVisible:e}),help:(0,a.__)("Usa Intersection Observer para cargar cuando el bloque entre en el viewport. Útil para lazy loading real sin clic.","lazy-load-block")}),(0,e.createElement)(t.ToggleControl,{label:(0,a.__)("Permitir ejecución de scripts","lazy-load-block"),checked:_,onChange:e=>c({allowScripts:e}),help:(0,a.__)("ADVERTENCIA DE SEGURIDAD: Solo activa esto si confías en el código. Los scripts solo se ejecutarán si tienes permisos de administrador (unfiltered_html).","lazy-load-block")}),_&&(0,e.createElement)(t.Notice,{status:"warning",isDismissible:!1},(0,a.__)("Los scripts embebidos se ejecutarán cuando el contenido se cargue. Asegúrate de que el código sea de una fuente confiable.","lazy-load-block")))),(0,e.createElement)("div",{...E},(0,e.createElement)("div",{className:"llb-editor-container"},(0,e.createElement)("div",{className:"llb-editor-header"},(0,e.createElement)("span",{className:"llb-editor-icon"},"⚡"),(0,e.createElement)("span",{className:"llb-editor-title"},(0,a.__)("Lazy Load Block","lazy-load-block")),(0,e.createElement)("span",{className:"llb-editor-badge"},k?"iframe":z?"script":"HTML")),k&&(0,e.createElement)(t.Notice,{status:"success",isDismissible:!1},(0,a.__)("¡Perfecto! El iframe NO se cargará hasta que el usuario haga clic. Esto mejorará tu PageSpeed.","lazy-load-block")),(0,e.createElement)(t.TextareaControl,{label:(0,a.__)("Contenido HTML (iframe, embed, etc.)","lazy-load-block"),value:r,onChange:e=>c({htmlContent:e}),placeholder:(0,a.__)("Pega aquí el código del iframe, embed o cualquier HTML que quieras cargar de forma diferida...","lazy-load-block"),rows:8,className:"llb-html-textarea"}),r&&(0,e.createElement)("div",{className:"llb-preview-section"},(0,e.createElement)(t.Button,{variant:"secondary",onClick:()=>y(!h)},h?(0,a.__)("Ocultar vista previa","lazy-load-block"):(0,a.__)("Mostrar vista previa","lazy-load-block")),h&&(0,e.createElement)("div",{className:"llb-preview-container"},(0,e.createElement)("p",{className:"llb-preview-notice"},(0,a.__)("Vista previa (en el frontend NO se cargará hasta hacer clic):","lazy-load-block")),(0,e.createElement)("div",{className:"llb-preview-content",dangerouslySetInnerHTML:{__html:r}}))),!r&&(0,e.createElement)(t.Placeholder,{icon:"performance",label:(0,a.__)("Lazy Load Block","lazy-load-block"),instructions:(0,a.__)("Pega el código HTML, iframe o embed que quieras cargar de forma diferida. El contenido solo se cargará cuando el usuario haga clic.","lazy-load-block")}),(0,e.createElement)("div",{className:"llb-editor-footer"},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,a.__)("Cómo funciona:","lazy-load-block"))," ",(0,a.__)("El contenido se guarda codificado y NO se renderiza en el HTML de la página. Solo se inyecta en el DOM cuando el usuario hace clic en el botón.","lazy-load-block"))))))},save:function(){return null}})})();